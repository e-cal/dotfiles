#!/usr/bin/env bash

if [[ $1 = "submodule" ]]; then
    echo "Initializing submodules..."
    cd $STOW_DIR
    git submodule update --init --recursive
fi

echo "Generating `hostname` dotfiles..."
stow --dir=$STOW_DIR --target=$DOTFILES global --dotfiles -R

echo "Linking `hostname` dotfiles..."
stow `hostname` -R

if [[ ! -d "$HOME/.config/zsh/oh-my-zsh" ]]; then
    cd $HOME/.config/zsh
    sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
    git clone https://github.com/jeffreytse/zsh-vi-mode ${ZSH_CUSTOM:-~/.config/zsh/oh-my-zsh/custom}/plugins/zsh-vi-mode
    git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.config/zsh/oh-my-zsh/custom}/plugins/zsh-syntax-highlighting
    git clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.config/zsh/oh-my-zsh/custom}/plugins/zsh-autosuggestions
fi
